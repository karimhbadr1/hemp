cognition_1<-reshape(data=cognition,
varying=1:6,
v.names = "score",
timevar = "indicator",
times = names(cognition),
direction = "long")
cognition_1[order(cognition_1$id),]
histogram(~score|indicator,data=cognition_1)
pairs(cognition)
bollen_plot(cognition,crit.value = .06)
cognition[c(202,53,111),]
apply(cognition,2,min)
apply(cognition,2,max)
round(correlations,3)
correlations<-cor(cognition)
round(correlations,3)
correlations<-cor(cognition)
round(correlations,3)
corr_diff<-correlations-cor(cognition[-c(202,53,111)])
round(corr_diff,3)
corr_diff<-correlations-cor(cognition[-c(202,53,101),])
round(corr_diff,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp$values,3)
lattice_scree(cognition)
library(psych)
fa.parallel(cognition,fm="ml")
lattice_pa(cognition)
one_factor<-factanal(cognition,factors = 1)
one_factor
two_factor<-factanal(cognition,factors=2)
two_factor
loadings(two_factor)
install.packages("GPArotation")
library(GPArotation)
oblimin(loadings(two_factor))
library(psych)
fa(r=cognition,nfactors=2,rotate="oblimin")
SAPA_subset<-subset(SAPA,select=c(letter.7:letter.58,rotate.3:rotate.8))
library(hemp)
cognition<-subset(interest,select=vocab:analyrea)
summary(cognition)
apply(cognition,2,var)
library(lattice)
cognition_1<-reshape(data=cognition,
varying=1:6,
v.names = "score",
timevar = "indicator",
times = names(cognition),
direction = "long")
cognition_1[order(cognition_1$id),]
histogram(~score|indicator,data=cognition_1)
pairs(cognition)
bollen_plot(cognition,crit.value = .06)
cognition[c(202,53,111),]
apply(cognition,2,min)
apply(cognition,2,max)
correlations<-cor(cognition)
round(correlations,3)
corr_diff<-correlations-cor(cognition[-c(202,53,101),])
round(corr_diff,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp$values,3)
lattice_scree(cognition)
library(psych)
fa.parallel(cognition,fm="ml")
lattice_pa(cognition)
one_factor<-factanal(cognition,factors = 1)
one_factor
two_factor<-factanal(cognition,factors=2)
two_factor
install.packages("GPArotation")
library(GPArotation)
oblimin(loadings(two_factor))
library(psych)
fa(r=cognition,nfactors=2,rotate="oblimin")
library(hemp)
cognition<-subset(interest,select=vocab:analyrea)
summary(cognition)
apply(cognition,2,var)
library(lattice)
cognition_1<-reshape(data=cognition,
varying=1:6,
v.names = "score",
timevar = "indicator",
times = names(cognition),
direction = "long")
cognition_1[order(cognition_1$id),]
histogram(~score|indicator,data=cognition_1)
pairs(cognition)
bollen_plot(cognition,crit.value = .06)
cognition[c(202,53,111),]
apply(cognition,2,min)
apply(cognition,2,max)
correlations<-cor(cognition)
round(correlations,3)
corr_diff<-correlations-cor(cognition[-c(202,53,101),])
round(corr_diff,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp$values,3)
lattice_scree(cognition)
library(psych)
fa.parallel(cognition,fm="ml")
lattice_pa(cognition)
one_factor<-factanal(cognition,factors = 1)
one_factor
two_factor<-factanal(cognition,factors=2)
two_factor
#install.packages("GPArotation")
library(GPArotation)
oblimin(loadings(two_factor))
library(psych)
fa(r=cognition,nfactors=2,rotate="oblimin")
SAPA_subset<-subset(SAPA,select=c(letter.7:letter.58,rotate.3:rotate.8))
View(SAPA_subset)
fa.parallel(SAPA_subset,cor="poly")
EFA_SAPA<-fa(SAPA_subset,2,rotate="oblimin",cor="poly")
EFA_SAPA<-fa(SAPA_subset,2,rotate="oblimin",cor="poly")
EFA_SAPA
?factanal
SAPA_cor<-polychoric(SAPA_subset)
SAPA_cor
SAPA_cor$rho
factanal(SAPA_cor$rho,factors=2,n.obs=nrow(SAPA))
factanal(covmat=SAPA_cor$rho,factors=2,n.obs=nrow(SAPA))
library(lavaan)
library(lavaan)
iq_mod<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+objetc+coding'
iq_fit<-cfa(iq_mod,data=wiscsem)
iq_mod<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object+coding'
iq_fit<-cfa(iq_mod,data=wiscsem)
head(wiscsem)
inspect(iq_fit)
summary(iq_fit)
iq_fit
unique_elements(iq_fit)
?unique_elements
View(iq_fit)
iq_fit@SampleStats@cov[[1]]
11*11
121/2
unique_elements(iq_fit@SampleStats@cov)
unique_elements(iq_fit@SampleStats@cov[[1]])
unique_elements(iq_fit@SampleStats@cov[1])
free_params(iq_fit)
unique(iq_fit@SampleStats@cov)
unique(iq_fit@SampleStats@cov[[1]])
1+2+3+4+5+6+7+8+9+10+11
?free_params
summary(iq_fit,standardized=TRUE,fit.measures=TRUE)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE)
fitmeasures(iq_fit)
inspect(iq_fit,"rsquare")
summary(iq_fit,rsquare=TRUE)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE,rsquare=TRUE)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE,rsquare=TRUE)
iq_fit_nocode<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object'
iq_mod_nocode<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object'
iq_fit_nocode<-cfa(iq_mod_nocode,wiscsem)
summary(iq_fit_nocode)
nocode<-fitmeasures(iq_fit_nocode,fit.measures = c("rmsea","tli","cfi"))
code<-fitmeasures(iq_fit,fit.measures = c("rmsea","tli","cfa"))
rbind(nocode,code)
anova(iq_fit,iq_fit_nocode)
anova(iq_fit_nocode,iq_fit_mi)
library(hemp)
cognition<-subset(interest,select=vocab:analyrea)
summary(cognition)
apply(cognition,2,var)
library(lattice)
cognition_1<-reshape(data=cognition,
varying=1:6,
v.names = "score",
timevar = "indicator",
times = names(cognition),
direction = "long")
cognition_1[order(cognition_1$id),]
histogram(~score|indicator,data=cognition_1)
pairs(cognition)
bollen_plot(cognition,crit.value = .06)
cognition[c(202,53,111),]
apply(cognition,2,min)
apply(cognition,2,max)
correlations<-cor(cognition)
round(correlations,3)
corr_diff<-correlations-cor(cognition[-c(202,53,101),])
round(corr_diff,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp$values,3)
lattice_scree(cognition)
library(psych)
fa.parallel(cognition,fm="ml")
lattice_pa(cognition)
one_factor<-factanal(cognition,factors = 1)
one_factor
two_factor<-factanal(cognition,factors=2)
two_factor
#install.packages("GPArotation")
library(GPArotation)
oblimin(loadings(two_factor))
library(psych)
fa(r=cognition,nfactors=2,rotate="oblimin")
SAPA_subset<-subset(SAPA,select=c(letter.7:letter.58,rotate.3:rotate.8))
fa.parallel(SAPA_subset,cor="poly")
EFA_SAPA<-fa(SAPA_subset,2,rotate="oblimin",cor="poly")
EFA_SAPA
SAPA_cor<-polychoric(SAPA_subset)
factanal(covmat=SAPA_cor$rho,factors=2,n.obs=nrow(SAPA))
library(lavaan)
iq_mod<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object+coding'
iq_fit<-cfa(iq_mod,data=wiscsem)
inspect(iq_fit)
summary(iq_fit)
unique_elements(iq_fit)
free_params(iq_fit)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE)
fitmeasures(iq_fit)
inspect(iq_fit,"rsquare")
summary(iq_fit,rsquare=TRUE)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE,rsquare=TRUE)
iq_mod_nocode<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object'
iq_fit_nocode<-cfa(iq_mod_nocode,wiscsem)
summary(iq_fit_nocode)
nocode<-fitmeasures(iq_fit_nocode,fit.measures = c("rmsea","tli","cfi"))
code<-fitmeasures(iq_fit,fit.measures = c("rmsea","tli","cfa"))
rbind(nocode,code)
anova(iq_fit_nocode,iq_fit)
modind_iq<-modindices(iq_fit_nocode,sort=TRUE)
modind_iq<-modindices(iq_fit_nocode,sort=TRUE)
modind_iq[modind_iq$mi>3.84,]
9.853-0.534
iq_mod_mi<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object+comp
'
iq_fit_mi<-cfa(iq_mod_mi,wiscsem)
fitmeasures(iq_fit_mi,c("rmsea","tli","cfi","srmr"))
summary(iq_fit_mi)
55.305-45.276
55.305-45.276-0.534
anova(iq_fit_nocode,iq_fit_mi)
iq_fit_mi@call
iq_fit_mi@call@Model
iq_fit_mi@call$model
iq_mod_mi
print(iq_mod_mi)
c(iq_mod_mi)
cat(iq_mod_mi)
cat(iq_mod_nocode)
cat(iq_mod_code)
cat(iq_mod)
clear
iq_mod
cat(iq_mod)
cat(iq_mod_nocode)
cat(iq_mod_mi)
anova(iq_fit,iq_fit_mi)
factor_scores<-predict(iq_fit_mi)
head(factor_scores)
fitted(iq_fit_mi)
residuals(iq_fit_mi)
wiscsem_cat<-wiscsem
wiscsem_cat[,]<-lapply(wiscsem_cat[,],quart_cut)
View(wiscsem_cat)
wiscsem_ord<-wiscsem_cat
wiscsem_ord[,]<-lapply(wiscsem_ord[,],ordered)
View(wiscsem_ord)
describe(wiscsem_cat)
summary(wiscsem_cat)
summary(wiscsem_ord)
lapply(wiscsem_ord, type)
lapply(wiscsem_ord, class)
lapply(wiscsem_cat, class)
iq_fit_ord1<-cfa(iq_mod,wiscsem_ord)
summary(iq_fit_ord1)
iq_fit_ord2<-cfa(iq_mod,wiscsem_cat,ordered=names(wiscsem_cat))
summary(iq_fit_ord2)
library(hemp)
cognition<-subset(interest,select=vocab:analyrea)
summary(cognition)
apply(cognition,2,var)
library(lattice)
cognition_1<-reshape(data=cognition,
varying=1:6,
v.names = "score",
timevar = "indicator",
times = names(cognition),
direction = "long")
cognition_1[order(cognition_1$id),]
histogram(~score|indicator,data=cognition_1)
pairs(cognition)
bollen_plot(cognition,crit.value = .06)
cognition[c(202,53,111),]
apply(cognition,2,min)
apply(cognition,2,max)
correlations<-cor(cognition)
round(correlations,3)
corr_diff<-correlations-cor(cognition[-c(202,53,101),])
round(corr_diff,3)
eigen_decomp<-eigen(correlations)
round(eigen_decomp$values,3)
lattice_scree(cognition)
library(psych)
fa.parallel(cognition,fm="ml")
lattice_pa(cognition)
one_factor<-factanal(cognition,factors = 1)
one_factor
two_factor<-factanal(cognition,factors=2)
two_factor
#install.packages("GPArotation")
library(GPArotation)
oblimin(loadings(two_factor))
library(psych)
fa(r=cognition,nfactors=2,rotate="oblimin")
SAPA_subset<-subset(SAPA,select=c(letter.7:letter.58,rotate.3:rotate.8))
fa.parallel(SAPA_subset,cor="poly")
EFA_SAPA<-fa(SAPA_subset,2,rotate="oblimin",cor="poly")
EFA_SAPA
SAPA_cor<-polychoric(SAPA_subset)
factanal(covmat=SAPA_cor$rho,factors=2,n.obs=nrow(SAPA))
library(lavaan)
iq_mod<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object+coding'
iq_fit<-cfa(iq_mod,data=wiscsem)
inspect(iq_fit)
summary(iq_fit)
unique_elements(iq_fit)
free_params(iq_fit)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE)
fitmeasures(iq_fit)
inspect(iq_fit,"rsquare")
summary(iq_fit,rsquare=TRUE)
summary(iq_fit,standardized=TRUE,fit.measures=TRUE,rsquare=TRUE)
iq_mod_nocode<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object'
iq_fit_nocode<-cfa(iq_mod_nocode,wiscsem)
summary(iq_fit_nocode)
nocode<-fitmeasures(iq_fit_nocode,fit.measures = c("rmsea","tli","cfi"))
code<-fitmeasures(iq_fit,fit.measures = c("rmsea","tli","cfa"))
rbind(nocode,code)
anova(iq_fit_nocode,iq_fit) #based on different set of observed vars so not considered to be nested
modind_iq<-modindices(iq_fit_nocode,sort=TRUE)
modind_iq[modind_iq$mi>3.84,]
iq_mod_mi<-'
verb=~info+comp+arith+simil+digit+vocab
perf=~pictcomp+parang+block+object+comp
'
iq_fit_mi<-cfa(iq_mod_mi,wiscsem)
fitmeasures(iq_fit_mi,c("rmsea","tli","cfi","srmr"))
summary(iq_fit_mi)
anova(iq_fit_nocode,iq_fit_mi)
anova(iq_fit,iq_fit_mi)
factor_scores<-predict(iq_fit_mi)
head(factor_scores)
fitted(iq_fit_mi)
residuals(iq_fit_mi)
wiscsem_cat<-wiscsem
wiscsem_cat[,]<-lapply(wiscsem_cat[,],quart_cut)
wiscsem_ord<-wiscsem_cat
wiscsem_ord[,]<-lapply(wiscsem_ord[,],ordered)
library(mirt)
library(hemp)
onepl_mod<-"F=1-16
CONSTRAIN=(1-16,a1)"
onepl_fit<-mirt(data=SAPA,model=onepl_mod,SE=TRUE)
onepl_fit
summary(onepl_fit)
onepl_params<-coef(onepl_fit,IRTpars=TRUE,simplify=TRUE)
onepl_params
onepl_items<-onepl_params$items
onepl_items
onepl_se<-coef(onepl_fit,printSE=TRUE)
onepl_se
plot(onepl_fit,type="trace",which.items=1:2)
itemplot(onepl_fit,type="trace",item=1)
plot(onepl_fit,type="infotrace",which.items=c(3,5))
plot(onepl_fit,type="trace",which.items=1:2,facet_items=FALSE,
auto.key=list(points=FALSE,lines=TRUE,columns=2),
par.settings=simpleTheme(lty=1:2))
library(latticeExtra)
plot(onepl_fit,type="infoSE",theta_lim=c(-3,3))
rasch_mod<-"F=1-16"
rasch_fit<-mirt(data=SAPA,model=rasch_mod,itemtype="Rasch",SE=TRUE)
rasch_fit
coef(rasch_fit,printSE=TRUE)
rasch_params<-coef(rasch_fit,IRTpars=TRUE,simplify=TRUE)
rasch_items<-rasch_params$items
rasch_items
plot(rasch_fit,type="trace",which.items=c(1,2))
twwopl_mod<-"F=1-16"
twopl_fit<-mirt(data=SAPA,model=twwopl_mod,itemtype="2PL",SE=TRUE)
twopl_fit
twopl_params
twopl_params<-coef(twopl_fit,IRTpars=TRUE,simplify=TRUE)
twopl_params
twopl_params<-coef(twopl_fit,IRTpars=TRUE,simplify=TRUE)
twopl_items<-twopl_params$items
twopl_items
plot(twopl_fit,type="trace",which.items=c(12,14))
plot(twopl_fit,type="trace",which.items=c(5,16),
facet_items=FALSE,auto.key=list(points=FALSE),lines=TRUE,columns=2,par.settings=simpleTheme(lty=1:2))
threepl_mod<-"F=1-16"
threepl_fit<-mirt(data=SAPA,model="threepl_mod",itemtype = "3PL",SE="TRUE")
threepl_mod<-"F=1-16"
threepl_fit<-mirt(data=SAPA,model=threepl_mod,itemtype = "3PL",SE="TRUE")
threepl_mod<-"F=1-16"
threepl_fit<-mirt(data=SAPA,model=threepl_mod,itemtype = "3PL",SE=TRUE)
threepl_fit
threepl_params<-coef(threepl_fit,IRTpars=TRUE,simplify=TRUE)
threepl_items<-threepl_items$items
threepl_params<-coef(threepl_fit,IRTpars=TRUE,simplify=TRUE)
threepl_items<-threepl_params$items
threepl_items
plot(threepl_fit,type="trace",which.items=c(1,4),
facet_items=FALSE,auto.key=list(points=FALSE,lines=TRUE,columns=2),
par.settings=simpleTheme(lty=1:2))
fourpl_mod<-"F=1-16"
fourpl_fit<-mirt(data=SAPA,model=fourpl_mod,itemtype = "4PL",SE=TRUE)
fourpl_fit
fourpl_params<-coef(forupl_fit,IRTpars=TRUE,simplify=TRUE)
fourpl_params<-coef(fourpl_fit,IRTpars=TRUE,simplify=TRUE)
fourpl_items<-fourpl_params$items
fourpl_items
plot(fourpl_fit,type="trace",which.items=c(13,16))
latent_mle<-fscores(twopl_fit,method="ML",full.scores = TRUE,full.scores.SE = TRUE)
latent_map<-fscores(twopl_fit,method="MAP",full.scores=TRUE,full.scores.SE = TRUE)
latent_eap<-fscores(twopl_fit,method="EAP",full.scores = TRUE,full.scores.SE = TRUE)
SAPA[368,]
SAPA[614,]
SAPA[996,]
twopl_fit
View(twopl_fit)
info(SAPA)
SAPA
dim(SAPA)
SAPA[73,]
latent_mle
head(latent_mle)
latent<-data.frame(MLE=latent_mle[,1],
MAP=latent_map[,1],
EAP=latent_eap[,1])
head(latent)
latent[c(73,89,103,105),]
1525-1461
latent_est<-latent[is.finite(latent$MLE),]
apply(latent_est,2,summary)
apply(latent_est,2,sd)
cor(latent_est)
pairs(latent_est)
rmsd(latent_est$MLE,latent_est$MAP)
rmsd(latent_est$MLE,latent_est$EAP)
rmsd(latent_est$MAP,latent_est$EAP)
rasch_itemfit<-itemfit(rasch_fit,
fit_stats = c("S_X2","G2"),
impute=10)
?itemfit
rasch_itemfit<-itemfit(rasch_fit,
fit_stats = c("S_X2","G2"))
rasch_itemfit<-itemfit(rasch_fit,
fit_stats = c("S_X2","G2"),
na.rm = TRUE)
rasch_itemfit
rasch_fit
View(rasch_fit)
16-1
rasch_itemfit<-itemfit(rasch_fit,
fit_stats = c("S_X2","G2"),
na.rm = TRUE,
impute=10)
rasch_itemfit
rasch_itemfit<-itemfit(rasch_fit,
fit_stats = c("S_X2","G2"),
na.rm = TRUE)
rasch_itemfit
itemfit(rasch_fit,fit_stats = c("Zh","infit"),impute=10)
itemfit(rasch_fit,fit_stats = c("Zh","infit"),na.rm = TRUE)
itemfit(rasch_fit,empirical.plot = 1)
SAPA_nomiss<-na.omit(SAPA)
rasch_mod<-"F=1-16"
rasch_fit<-mirt(data=SAPA_nomiss,model=rasch_mod,itemtype = "Rasch",SE=TRUE,verbose = FALSE)
rasch_personfit<-personfit(rasch_fit)
rasch_personfit
SAPA_nomiss<-na.omit(SAPA)
rasch_mod<-"F=1-16"
rasch_fit<-mirt(data=SAPA_nomiss,model=rasch_mod,itemtype = "Rasch",SE=TRUE,verbose = FALSE)
rasch_personfit<-personfit(rasch_fit)
head(rasch_personfit)
hist(rasch_personfit$Zh,xlab="Zh Statistic")
abline(v=-2,lwd=2,lty=2)
rasch_misfits<-subset(rasch_personfit,Zh<-2)
rasch_misfits<-subset(rasch_personfit,Zh< -2)
rownames(rasch_misfits)
nrow(rasch_misfits)
anova(onepl_fit,twopl_fit)
anova(twopl_fit,threepl_fit)
anova(threepl_fit,fourpl_fit)
